/** Copyright 2023 Amazon.com Inc. or its affiliates. All Rights Reserved. **/
define(["jquery","jquery-cookie","jqueryHelper","argumentNullError","queryParametersHelper","stringHelper","windowHelper","idlerHelper","misc","userRepository"],function($,e,n,i,t,o,u,a,g,r){var l={cultureCodeAttributeName:"data-culture-code",languageCookieName:"AWSTraining_LMS_Language"};l.lblSelectedLanguage=$("#lblSelectedLanguage"),l.divSelectedLanguage=$("#divSelectedLanguage"),l.divLanguageOptions=$("#divLanguageOptions");return l.initialize=function(e,t,a){if(!e)throw i.createInstance("lblSelectedLanguage");if(!t)throw i.createInstance("divSelectedLanguage");if(!a)throw i.createInstance("divLanguageOptions");a.find("a").click({lblSelectedLanguage:e,divLanguageOptions:a},function(e){return l.onLanguageSelected($(this).attr(l.cultureCodeAttributeName)),!1}),a.find("a").keydown({lblSelectedLanguage:e,divLanguageOptions:a},function(e){" "==e.key?this.click():27==e.keyCode&&(e.preventDefault(),a.hide(),t.focus())}),t.on("keydown",function(e){"Enter"==e.key||" "==e.key?(e.preventDefault(),a.toggle()):27==e.keyCode&&(e.preventDefault(),a.hide())})},l.showOptions=function(e){!0===e&&(e=l.divSelectedLanguage.offset().left+l.divSelectedLanguage.width()-l.divLanguageOptions.width()+22,l.divLanguageOptions.css("top",35),l.divLanguageOptions.css("left",e+"px")),l.divSelectedLanguage.addClass("selected"),l.divLanguageOptions.show()},l.setDefaultLanguage=function(e,t){if(!e)throw i.createInstance("lblSelectedLanguage");if(!t)throw i.createInstance("divLanguageOptions");t=l.getDefaultLanguage(t),e.html(t)},l.mobileOptionsDiv=n.select(".kiku-mobile-language-options"),l.mobileOptions=n.select(".kiku-mobile-language-options div.submenu-option"),l.initializeMobileMenu=function(){var e;g.validateObjectParameter(l.mobileOptions,"languageOptions.mobileOptions"),l.mobileOptions.click(function(){l.mobileLanguageOptionClicked($(this))}),e=l.getCurrentLanguageCode(),l.mobileOptionsDiv.find("a["+l.cultureCodeAttributeName+"='"+e+"']").addClass("active")},l.mobileLanguageOptionClicked=function(e){g.validateObjectParameter(e,"optionDiv"),l.onLanguageSelected(e.attr(l.cultureCodeAttributeName))},l.onLanguageSelected=function(e){o.isStringNullOrWhiteSpace(e)&&(e="en-us"),n.getCurrentCultureCode()!==e&&(l.setLanguageCookie(e),l.divLanguageOptions.hide(),a.showFull(),l.updatePreferredLanguageCode())},l.setLanguageCookie=function(e){if(o.isStringNullOrWhiteSpace(e))throw i.createInstance("languageCode");$.cookie(this.languageCookieName,e,{path:"/",expires:1e4})},l.getDefaultLanguage=function(e){var t;return g.validateObjectParameter(e,"divLanguageOptions"),t=l.getCurrentLanguageCode(),e.find("a["+l.cultureCodeAttributeName+"='"+t+"']").html()},l.getCurrentLanguageCode=function(){var e,t=!0,a=(n.getCurrentCultureCode()||"").toLowerCase().trim();return a||(e=$.cookie(l.languageCookieName),o.isStringNullOrWhiteSpace(e))||(t=!1,a=e.toLowerCase().trim()),o.isStringNullOrWhiteSpace(a)&&(a="en-us"),!0===t&&l.setLanguageCookie(a),a},l.updatePreferredLanguageCode=function(){r.getCurrent(l.getCurrentUserCompleted,l)},l.getCurrentUserCompleted=function(e,t,a){e&&!t&&(t=$.cookie(l.languageCookieName))?(e.PreferredLanguageCode=t,r.updateProfile(e,l.getUpdateUserProfileCompleted,l)):u.reloadPage()},l.getUpdateUserProfileCompleted=function(e,t,a){u.reloadPage()},l});